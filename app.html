<!DOCTYPE html>
<html>
<head>
    <title> Room Light </title>
    <link rel="icon" href="icon.png">
	
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	
    <!-- see http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <style>
        @-ms-viewport { width: 100vw ; zoom: 100% ; }  @viewport { width: 100vw ; zoom: 100% ; }
        @-ms-viewport { user-zoom: fixed ; }           @viewport { user-zoom: fixed ; }
    </style>

    
    <link href="css/bootstrap.css" rel="stylesheet">
    
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    
    <link href="https://code.jquery.com/ui/1.12.1/themes/excite-bike/jquery-ui.css" rel="stylesheet">

    <link href="slider/bootstrap-slider.min.css" rel="stylesheet">
        
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js" ></script>

    <script type="text/javascript" src="js/color.js"></script>
    <script type="text/javascript" src="slider/js/bootstrap-slider.min.js"></script>
</head>

<body>
<div class="container">
    
    <nav class="navbar navbar-default" role="navigation">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">LightBulb</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="active"><a  data-toggle="tab" href="#home">Home</a></li>
            <li class=""><a data-toggle="tab" href="#rainbow">Rainbow</a></li>
            <li class=""><a data-toggle="tab" href="#xmas1">Christmas Mode 1</a></li>
            <li class=""><a data-toggle="tab" href="#xmas2">Christmas Iterate</a></li>
            <li class=""><a data-toggle="tab" href="#fade">Fade 2 Colors</a></li>
			<li class=""><a data-toggle="tab" href="#exp">Experimental</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

	<div class="tab-content clearfix"> 
	
      <div class="tab-pane active" id="home"> <!-- home/fixed -->
        <h3>LET THERE BE LIGHT!</h3>
		
		<div class="row"> 
          <div class="col-xs-12">
            <button class="btn btn-light" onclick="StartSetFixed('ffffff','255');"> White </button>
			<button class="btn btn-primary" onclick="StartSetFixed('0000ff','255');"> Blue </button>
            <button class="btn btn-danger" onclick="StartSetFixed('ff0000','255');"> Red </button>
            <button class="btn btn-success" onclick="StartSetFixed('008000','255');"> Green </button>
            <button class="btn btn-warning" onclick="StartSetFixed('ffff00','255');"> Yellow </button>
            <button class="btn btn-danger" onclick="StartSetFixed('7C3131','255');"> Pink </button>
          </div>
        </div>
		<div class="col-xs-12">
		  <br><br>Or Pick A Color<button id="FixedColorHome" class="jscolor {onFineChange:'setColorValue(this)'}" >
			  
		  </button>
			<br><br> Change Brightness <input type="text" id="FixedBrightnessHome" name="FixedBrightnessHome" data-provide="slider" onchange="setBrightnessValue();" data-slider-min="1" data-slider-max="255" data-slider-step="1" data-slider-value="255" data-slider-tooltip="hide" >
		</div>
		
		<br><br>
		  <div class="col-xs-12">
            <br><br><button class="btn btn-danger" onclick="Stop();"> Turn off light </button>
          </div>
      </div> <!-- ./tab-pane -->

      <div class="tab-pane" id="rainbow"> <!-- rainbow -->
        <div class="clearfix">&nbsp;</div>
        <div class="row"> 
          <div class="col-xs-12">
            <button class="btn btn-danger" onclick="StartRainbow();"> Start Rainbow </button>

            <div class="col-xs-12">
              <br><br> Speed <input type="text" id="rainbowspeed" name="rainbowspeed" data-provide="slider" onchange="UpdateRainbowSpeed();" data-slider-min="1" data-slider-max="100" data-slider-step="1" data-slider-value="10" data-slider-tooltip="hide" >
            </div>
          </div>
        </div>
      </div> <!-- ./tab-pane -->

      <div class="tab-pane" id="fade"> <!-- fade -->
          <p> Use this mode to fade the strip between two colors </p>
          <button
              class="jscolor {valueElement:Fade2Colors1,value:'66ccff'} pull"
              style="border:2px solid black">
              Pick Color 1
          </button>
          <input style="display:none;" id="Fade2Colors1">
          <input style="display:none;" id="Fade2Colors2">
          <button
              class="jscolor {valueElement:Fade2Colors2,value:'66ccff'} push"
              style="border:2px solid black" onchange='console.log("here");'>
              Pick Color 2
          </button>          
          <br><br>
          <div style="width:100%;text-align:center;">
            <button class="btn btn-success" type="button" onclick="Start2Fade();"> Apply </button>
          </div> 
          <br><br> Fade Speed: <input type="text" id="fadespeed" name="rainbowspeed" data-provide="slider" onchange="UpdateFadeSpeed();" data-slider-min="1" data-slider-max="100" data-slider-step="1" data-slider-value="10" data-slider-tooltip="hide" >

      </div> <!-- ./tab-pane -->

      <div class="tab-pane" id="xmas1"> <!-- xmas blink -->
          <button class="btn btn-success" type="button" onclick="StartXmas1();"> Start Christmas Mode 1 </button>
      </div> <!-- ./tab-pane -->     
      
      <div class="tab-pane" id="xmas2"> <!-- xmas scroll -->
	  
          <button class="btn btn-success" type="button" onclick="StartXmas2();"> Start Christmas Iterate </button>
      </div> <!-- ./tab-pane -->           
	
	  <div class="tab-pane" id="exp"> <!-- experimental patterns -->
		<div class="col-xs-12">
		    <br><br>Pick A Color<button class="jscolor {valueElement:setColorExp,value:'ffffff'}" pull > </button>
			<br><br>Or Check To Use Random Color <input id="randomColorExp" name="RandomColor" type="checkbox" value="Random" class="checkbox">
			<button class="btn btn-success" type="button" onclick="StartExperimental();"> Start </button>
		  </div>
      </div> <!-- ./tab-pane -->        
	  
	</div> <!-- ./tab-content -->

</div> <!-- /.container -->



  <script>

    /*******************************
      control
    *******************************/         
      function Stop() {
        AnimationRequest("control", "Stop", null);
      }

    /*******************************
      xmas
    *******************************/
      function StartXmas1() {
        AnimationRequest("xmas", "GoXmas1", null);
      }
      function StartXmas2() {
          AnimationRequest("xmas", "GoXmasIterate", null);
      }

    /*******************************
      fade
    *******************************/
      function Start2Fade() {
        var args = {
          Color1: $("#Fade2Colors1").val(),
          Color2: $("#Fade2Colors2").val()
        };
        AnimationRequest("fade", "GoFade2", args);
      }
      function UpdateFadeSpeed() {
        var args = {
          speed: $("#fadespeed").val()
        };
        AnimationRequest("fade", "FadeSpeed", args);
      }


    /*******************************
      rainbow
    *******************************/
      function StartRainbow() {
        AnimationRequest("rainbow", "GoRainbow", null);
      }
      function UpdateRainbowSpeed() {
        var args = {
          speed: $("#rainbowspeed").val()
        };
        AnimationRequest("rainbow", "RainbowSpeed", args);
      }
	  
	/*******************************
      fixed
    *******************************/
	function setColorValue(jscolor)
	{
		var colorValue = jscolor.toHEXString().replace('#','');
		console.log("set color value: ");
		console.log(colorValue);
		
		StartSetFixed(colorValue,null);
	}
	function setBrightnessValue()
	{
		var brightnessValue = document.getElementById('FixedBrightnessHome').value;
		console.log("set brightness value: ");
		console.log(brightnessValue);
		StartSetFixed(null, brightnessValue);
	}
	
	var lastColor = "FFFFFF";
	var lastBrightness = "255";
	
	function StartSetFixed(ColorInput, BrightnessInput) {
		var brightnessToSet="255";
		var colorToSet="ffffff";
		if (BrightnessInput == null) { brightnessToSet=lastBrightness; } else { brightnessToSet=BrightnessInput; }
		if (ColorInput == null) {colorToSet =lastColor;}else{colorToSet =ColorInput;}
		
		var args = {
          Color1: colorToSet, //Color1: "ffffff",
          Brightness: brightnessToSet //Brightness: "255"
        };
		lastColor = colorToSet;
		lastBrightness = brightnessToSet;
		
		console.log(args);
		console.log("lastcolor:" + lastColor);
		
        AnimationRequest("fixed", "fixedLighting", args);
      }
	  
	/*******************************
      experimental
    *******************************/
      function StartExperimental() {
	  
		var blinkMode = "setColor";
		if (document.getElementById('randomColorExp').checked){
			blinkMode = "random";
		};

		console.log("experimental mode:" + mode);
		console.log("experimental color:" + $("#setColorExp").val());
		
		var args = {
          mode: blinkMode, 
          color: $("#setColorExp").val()
        };
        AnimationRequest("experimental", "StarryNight", args);
      }

    /*******************************
      common
    *******************************/
      function AnimationRequest(lib, method, args) {
		console.log(lib);
		console.log(method);
		console.log(args);
        $Strip.POST("AnimationRequest", { lib: lib, method: method, args: args });
      }

      $(document).on('click','.navbar-collapse.in',function(e) {
        if( $(e.target).is('a') ) {
            $(this).collapse('hide');
        }
      });
		
    /*******************************
      deprecated
    *******************************/
      function StartDancing() {
        $Strip.BasicGET("dance");
      }

      function StartTwinkling() {
        $Strip.BasicGET("twinkle");
      }

      function UpdateDanceSpeed() {
       $Strip.POST( "dancespeed", { speed: $("#dancespeed").val() } ); 
      }

      function fade() {
        $Strip.BasicGET("fade");
      } 

      function spin() {
        $Strip.BasicGET("spin");
      }

      var $Strip = {} || $Strip;

      $Strip = {
        ColorPicker: "",
        Interval: "",
        CanSubmitOverride: true,
        CanSubmit: true,

        SetColorGroup: function(hex, array) {
          $(".colorpicker_hex input").val("#0066ff").trigger("change");
        },

        SetColor: function(hex, index) {
          if ($Strip.CanSubmit || $Strip.CanSubmitOverride) {
            $Strip.POST("color", { color: hex, index: index });
            $Strip.CanSubmit = false;
          }        
        },
        Start: function() {
          $Strip.BasicGET("pulse");
        }, 
        Stop: function() {
          $Strip.BasicGET("istop");
        }, 
        POST: function(action,data) {
          $.ajax({
              url: '/'+action,
              type: 'POST',
              data: data,
            })
            .done(function() {
            })
            .fail(function() {
            })
            .always(function() {
              $Strip.CanSubmit = true;
            });
        },
        BasicGET: function(action) {
            $.ajax({
              url: '/'+action,
              type: 'GET',
              data: {},
            })
            .done(function() {
            })
            .fail(function() {
            })
            .always(function() {
            });
        }
      };

      function prepareColors() {
        $Strip.ColorPicker = $("[data-role='colorpicker']").each(function(){
          var index = $(this).data("index");
          CurrentArrayObjects[index] = $(this).ColorPicker({
            flat: true,
            onChange: function (hsb, hex, rgb) {
              $Strip.SetColor(hex, index);
            }
          });
        });
      }
    
      var CurrentArray = [];
      var CurrentArrayObjects = [];

  </script>



</body>
</html>





